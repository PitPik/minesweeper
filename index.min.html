<!doctype html><html lang="en"><head><meta charset="utf-8"><style>body,html{height:100%;font:.90em/1.6em "Trebuchet MS",Arial;color:#333;margin:0;padding:0}body{display:flex;text-align:center;cursor:default}.game{padding:3px;border:3px solid #ddd;border-radius:4px;margin:auto}.header{padding:2px 5px;margin:0 -3px 3px;border-bottom:1px solid #ddd}.counter,.timer{min-width:1.6em;padding:7px 3px;line-height:16px;text-align:left;float:left;font-size:1.5em;color:#666}.timer{float:right;text-align:right}.game select{margin-top:-3px;height:1.8em;border:none;font-size:inherit;color:#666;width:100%}.game button:focus,.game select:focus{outline:0}.game button{position:relative;padding:14px;margin:0 6px 3px;line-height:34px;border:1px solid #aaa;border-radius:50%;color:#666;background:#eee}.game button:after,.game button:before{content:"°";position:absolute}.game button:after{content:"o\00a0\00a0o";top:-9px;left:7px;font-size:8px}.game button:before{content:"─";top:2px;left:7px}.huh button:before{content:"o"}.loose button:before,.win button:before{content:"(";transform:rotate(70deg)}.loose button:after{content:"x\00a0\00a0x"}.loose button:before{left:12px}.win button:before{transform:rotate(-70deg)}.board tr{display:flex}.board td{color:green;font-weight:700;width:15px;height:15px;margin:1px;font-size:.9em;line-height:15px;border:1px dotted #ccc;border-radius:10%}@keyframes fn{0%,100%{transform:scale(1)}50%{transform:scale(0)}}.board .hidden{background:#eee;animation-name:fn;animation-duration:.7s;animation-delay:-.2s}.board .hidden:hover{background:#ccc}.board .mine,.board .mine:hover{background:#f4a460}.board .mine:after{content:"o";font-size:14px;line-height:13px}.board .mine.last{color:#fff;background:red}.board .marked,.board .marked:hover,.board .open,.board .open:hover{background:#00bfff}.board .marked:after{content:"!"}.board .open:after{content:"?"}.board .color-1{color:#00f}.board .color-2{color:green}.board .color-3{color:red}.board .color-4{color:#000}.board .color-5{color:#f4a460}</style><title>Minesweeper 4.79kB</title><body><div class="game"><div class="header"><select><option value="9,9,10">Beginner</option><option value="16,16,40">Intermediate</option><option value="16,30,99">Expert</option></select></div><div class="header"><div class="counter"></div><button type="button"></button><div class="timer"></div></div><table class="board"><tbody id="board"></tbody></table></div><script>!function(c){function l(t,o,a,i){for(let r=o-1,e=o+1;r<=e;r++)if(t[r])for(let e=a-1,n=a+1;e<=n;e++)!t[r][e]||r===o&&e===a||i(r,e,t[r][e])}function r(r,e,t,o,a,i){for(let e=r[0],n=r[1];e--;){for(t[e]=[],o&&o(t[e][n]),n=r[1];n--;)t[e][n]={mark:"",done:!1,mine:!1,x:e,y:n},a&&a(t[e][n]);i&&i(t[e][n])}return function(e,n,r){for(;r;){var t=Math.floor(Math.random()*n[0]),o=Math.floor(Math.random()*n[1]);e[t][o].mine||(e[t][o].mine=!0,r--,l(e,t,o,(e,n,r)=>{r.arround=isNaN(r.arround)?1:r.arround+1}))}return e}(t,r,e)}const d="marked";function o(r,t,o,a){for(let n=0;n<r.length;n++)for(let e=0;e<r[0].length;e++)r[n][e][t]===o&&a.push(r[n][e]);return a}function a(t,e,o,a,i){return l(t,e.x,e.y,(e,n,r)=>{i!==c?r.mark===d&&i++:!a&&(r.mine||r.done)||u(t,r,o,c)}),i}function u(e,n,r,t){if(n.done&&t!==c){if(delete u._win,a(e,n,r,!1,0)===n.arround&&a(e,n,r,!0),!1===u._win)return!1}else if(t&&!n.done)n.mark=n.mark===d?"open":"open"===n.mark?"":d;else{if(n.mine&&n.mark!==d)return o(e,"mine",!0,[]).forEach(e=>{e.mark=e===n?"mine last":"mine",r&&r(e)}),u._win=!1;n.mark===d||n.done||(n.mark="",n.done=!0,n.arround||a(e,n,r))}return r&&r(n),function(n){for(let e=n.length;e--;)if(!n[e].mine||n[e].mark!==d)return;return!0}(o(e,"done",!1,[]))}const i="textContent",m="className";var e="addEventListener";const t=document.body;var n=e=>document.querySelector(e);const s=n("#board"),f={gameBoard:s,select:n("select"),reset:n("button"),counter:n(".counter"),timer:n(".timer"),interval:0,check:c};function h(){const t=(e=f.select.value.split(","),f.interval=clearInterval(f.interval),f.timer[i]="0",{won:c,row:+e[0],col:+e[1],mines:+e[2]});var e;let n="";var o=r([t.row,t.col],t.mines,[],()=>n+="<tr>",()=>n+='<td class="hidden"></td>',()=>n+="</tr>");f.gameBoard.innerHTML=n,k(o,t),f.check=e=>{var n=e.target.cellIndex,r=e.target.parentNode.rowIndex;if(e.preventDefault(),n===c)return k(o,t);t.won===c&&(f.interval||(f.interval=setInterval(()=>f.timer[i]++,1e3)),t.won=u(o,o[r][n],e=>function(e,n){const r=e.children[n.x].children[n.y];r[m]=n.done?" color-"+n.arround:" hidden "+n.mark,r[i]=n.done?n.arround:""}(f.gameBoard,e),"contextmenu"===e.type),k(o,t),t.won!==c&&clearInterval(f.interval))}}function k(e,n){t[m]=n.won?"win":!1===n.won?"loose":"",!1!==n.won&&(f.counter[i]=n.mines-o(e,"mark","marked",[]).length)}s[e]("mousedown",e=>t[m]+=" huh"),s[e]("click",e=>f.check(e)),s[e]("contextmenu",e=>f.check(e)),f.select[e]("change",h),f.reset[e]("click",h),h()}();</script></body></html>

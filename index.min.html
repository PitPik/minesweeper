<!doctype html><html lang="en"><head><meta charset="utf-8"><style>body,html{height:100%;font:.90em/1.6em "Trebuchet MS";color:#333;margin:0;padding:0}body{display:flex;text-align:center;cursor:default}.game{padding:3px;border:3px solid #ddd;border-radius:4px;margin:auto}.header{padding:2px 5px;margin:0 -3px 3px;border-bottom:1px solid #ddd}.counter,.timer{min-width:1.6em;padding:7px 3px;line-height:16px;text-align:left;float:left;font-size:1.5em;color:#666}.timer{float:right;text-align:right}.game select{display:block;margin-top:-3px;height:1.8em;border:none;font-size:inherit;color:#666;width:100%}.game button:focus,.game select:focus{outline:0}.game button{position:relative;padding:14px;margin:0 6px 3px;line-height:34px;border:1px solid #aaa;border-radius:50%;color:#666;background:#eee}.game button:after,.game button:before{content:"°";position:absolute}.game button:after{content:"o\00a0\00a0o";top:-9px;left:7px;font-size:8px}.game button:before{content:"─";top:2px;left:7px}.huh button:before{content:"o"}.loose button:before,.win button:before{content:"(";transform:rotate(70deg)}.loose button:after{content:"x\00a0\00a0x"}.loose button:before{left:12px}.win button:before{transform:rotate(-70deg)}.board tr{display:flex}.board td{color:green;font-weight:700;width:15px;height:15px;margin:1px;font-size:.9em;line-height:15px;border:1px dotted #ccc;border-radius:10%}@keyframes fn{0%,100%{transform:scale(1)}50%{transform:scale(0)}}.board .hidden{background:#eee;animation-name:fn;animation-duration:.7s;animation-delay:-.2s}.board .hidden:hover{background:#ccc}.board .mine,.board .mine:hover{background:#f4a460}.board .mine:after{content:"o";font-size:14px;line-height:13px}.board .mine.last{color:#fff;background:red}.board .marked,.board .marked:hover,.board .open,.board .open:hover{background:#00bfff}.board .marked:after{content:"!"}.board .open:after{content:"?"}.board .color-1{color:#00f}.board .color-2{color:green}.board .color-3{color:red}.board .color-4{color:#000}.board .color-5{color:#f4a460}</style><title>Minesweeper</title><body><div class="game"><div class="header"><select><option value="9,9,10">Beginner</option><option value="16,16,40">Intermediate</option><option value="16,30,99">Expert</option></select></div><div class="header"><div class="counter"></div><button type="button"></button><div class="timer"></div></div><table class="board"><tbody id="board"></tbody></table></div><script>!function(c){function u(n,e,r,t){for(var o=e-1,a=e+1;o<=a;o++)if(n[o])for(var i=r-1,c=r+1;i<=c;i++)!n[o][i]||o===e&&i===r||t(o,i,n[o][i])}function r(n,e,r,t,o){for(var a=[],i=n[0];i--;){a[i]=[],r&&r(a[i][c]);for(var c=n[1];c--;)a[i][c]={mark:"",done:!1,mine:!1,x:i,y:c},t&&t(a[i][c]);o&&o(a[i][c])}return function(n,e,r){for(;r;){var t=Math.floor(Math.random()*e[0]),o=Math.floor(Math.random()*e[1]);n[t][o].mine||(n[t][o].mine=!0,r--,u(n,t,o,function(n,e,r){r.arround=isNaN(r.arround)?1:r.arround+1}))}return n}(a,n,e)}var d="marked";function o(n,e,r,t){for(var o=0;o<n.length;o++)for(var a=0;a<n[0].length;a++)n[o][a][e]===r&&t.push(n[o][a]);return t}function a(t,n,o,a,i){return u(t,n.x,n.y,function(n,e,r){i!==c?r.mark===d&&i++:!a&&(r.mine||r.done)||l(t,r,o,c)}),i}function l(n,e,r,t){if(e.done&&t!==c){if(delete l._win,a(n,e,r,!1,0)===e.arround&&a(n,e,r,!0),!1===l._win)return!1}else if(t&&!e.done)e.mark=e.mark===d?"open":"open"===e.mark?"":d;else{if(e.mine&&e.mark!==d)return o(n,"mine",!0,[]).forEach(function(n){n.mark=n===e?"mine last":"mine",r&&r(n)}),l._win=!1;e.mark===d||e.done||(e.mark="",e.done=!0,e.arround||a(n,e,r))}return r&&r(e),function(n){for(var e=n.length;e--;)if(!n[e].mine||n[e].mark!==d)return;return!0}(o(n,"done",!1,[]))}var i="textContent",m="className",n="addEventListener",e=document.querySelector.bind(document),t=document.body,f=e("#board"),s={gameBoard:f,select:e("select",f),reset:e("button",f),counter:e(".counter",f),timer:e(".timer",f),interval:0,check:c};function v(){var n,t=(n=s.select.selectedIndex,n=s.select[n].value.split(","),s.interval=clearInterval(s.interval),s.timer[i]="0",{won:c,row:+n[0],col:+n[1],mines:+n[2]}),e="",o=r([t.row,t.col],t.mines,function(){e+="<tr>"},function(){e+='<td class="hidden"></td>'},function(){e+="</tr>"});s.gameBoard.innerHTML=e,h(o,t),s.check=function(n){var e=n.target.cellIndex,r=n.target.parentNode.rowIndex;if(n.preventDefault(),e===c)return h(o,t);t.won===c&&(s.interval||(s.interval=setInterval(function(){s.timer[i]++},1e3)),t.won=l(o,o[r][e],function(n){var e;e=s.gameBoard,n=n,(e=e.children[n.x].children[n.y])[m]=n.done?" color-"+n.arround:" hidden "+n.mark,e[i]=n.done?n.arround:""},"contextmenu"===n.type),h(o,t),t.won!==c&&clearInterval(s.interval))}}function h(n,e){t[m]=e.won?"win":!1===e.won?"loose":"",!1!==e.won&&(s.counter[i]=e.mines-o(n,"mark","marked",[]).length)}v(),f[n]("mousedown",function(){t[m]+=" huh"}),f[n]("click",function(n){s.check(n)}),f[n]("contextmenu",function(n){s.check(n)}),s.select[n]("change",v),s.reset[n]("click",v)}();</script></body></html>